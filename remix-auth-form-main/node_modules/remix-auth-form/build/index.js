"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.FormStrategy = void 0;
const remix_auth_1 = require("remix-auth");
class FormStrategy extends remix_auth_1.Strategy {
    constructor() {
        super(...arguments);
        this.name = "form";
    }
    async authenticate(request, sessionStorage, options) {
        let form = await request.formData();
        let user;
        try {
            user = await this.verify({ form, context: options.context });
        }
        catch (error) {
            let message = error.message;
            return await this.failure(message, request, sessionStorage, options);
        }
        return this.success(user, request, sessionStorage, options);
    }
}
exports.FormStrategy = FormStrategy;
